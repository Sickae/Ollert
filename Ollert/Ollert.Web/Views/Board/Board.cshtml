@model BoardViewModel

@section Scripts {
    <script type="text/javascript">

        function toggleNewCardListWindow() {
            $('input.cardlist-new-input').val('');
            $('.cardlist-new').toggle();
            var inputContainer = $('.cardlist-new-input-container').slideToggle('fast');

            if (inputContainer.css('display') === 'block') {
                $('.cardlist-new-input').focus();
            }
        }

        function addNewCard(caller) {
            var emptyCard = $('.empty-card > .cardlist-card').clone();
            var list = $(caller).closest('.cardlist-container').find('.cardlist-content');

            list.append(emptyCard);
            emptyCard.show();
        }

        function addNewCardList() {
            var emptyList = $('.empty-cardlist > .cardlist-container').clone();
            var inputContainer = $('.cardlist-new-input-container').closest('.cardlist-container');
            var title = inputContainer.find('input.cardlist-new-input').val();

            emptyList.find('.cardlist-title').text(title);
            inputContainer.find('.cardlist-new').show();
            inputContainer.find('.cardlist-new-input-container').hide();
            $('.cardlist-list').append(emptyList).append(inputContainer);
        }

    </script>
}

<div class="row cardlist-list">
    @foreach (var cardList in Model.CardLists)
    {
        <div class="cardlist-container">
            <div class="cardlist-header">
                <div class="cardlist-title">@cardList.Name</div>
                <div class="cardlist-header-menu">
                    <a href="#">
                        <span class="fas fa-ellipsis-h"></span>
                    </a>
                </div>
            </div>
            <div class="cardlist-content">
                <div class="cardlist-wrapper">
                    @foreach (var card in cardList.Cards)
                    {
                        <div class="cardlist-card">
                            <div class="cardlist-card-icon cardlist-card-icon-edit">
                                <a href="#test">
                                    <span class="fas fa-pencil-alt"></span>
                                </a>
                            </div>
                            @foreach (var label in card.Labels)
                            {
                                <div class="cardlist-card-label-container">
                                    <div class="cardlist-card-label" style="background-color: @label.Color"></div>
                                </div>
                            }
                            @card.Name
                            @if (card.Comments.Any())
                            {
                                <div class="cardlist-card-icon cardlist-card-icon-comment">
                                    <span class="fas fa-comment"></span>
                                    @card.Comments.Count
                                </div>
                            }
                        </div>
                    }
                </div>
            </div>
            <div class="cardlist-card-new" onclick="addNewCard(this)">
                <span class="fas fa-plus"></span>
                Új kártya hozzáadása
            </div>
        </div>
    }

    <div class="cardlist-container">
        <div class="cardlist-content cardlist-new-input-container">
            <input class="cardlist-new-input" placeholder="Cím..." />
            <div class="cardlist-new-control">
                <a class="btn btn-cardlist-new" onclick="addNewCardList()">Mentés</a>
                <div class="cardlist-icon-cancel" onclick="toggleNewCardListWindow()">
                    <span class="fas fa-times"></span>
                </div>
            </div>
        </div>
        <div class="cardlist-content cardlist-new" onclick="toggleNewCardListWindow()">
            <span class="fas fa-plus"></span>
            Új lista hozzáadása
        </div>
    </div>
</div>

<div class="helper-divs">
    <div class="empty-card">
        <div class="cardlist-card">
            <div class="cardlist-card-icon cardlist-card-icon-edit">
                <a href="#">
                    <span class="fas fa-pencil-alt"></span>
                </a>
            </div>
            Új kártya (WIP)
        </div>
    </div>

    <div class="empty-cardlist">
        <div class="cardlist-container">
            <div class="cardlist-header">
                <div class="cardlist-title"></div>
                <div class="cardlist-header-menu">
                    <a href="#">
                        <span class="fas fa-ellipsis-h"></span>
                    </a>
                </div>
            </div>
            <div class="cardlist-content"></div>
            <div class="cardlist-card-new" onclick="addNewCard(this)">
                <span class="fas fa-plus"></span>
                Új kártya hozzáadása
            </div>
        </div>
    </div>
</div>
